(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{208:function(e,t,r){Promise.resolve().then(r.bind(r,4168))},4168:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return c}});var o=r(3827),i=r(4090),a=r(9799),n=r(9079);let s={async getSets(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;try{{let e=n.env.NEXT_PUBLIC_POKEMON_TCG_API_KEY;e&&(window.POKEMON_TCG_API_KEY=e)}let{findSetsByQueries:t}=await Promise.all([r.e(478),r.e(459)]).then(r.bind(r,2459));return await t({orderBy:"-releaseDate",page:e,pageSize:24})}catch(e){return console.error("Error fetching sets:",e),[]}},async getCards(e){try{{let e=n.env.NEXT_PUBLIC_POKEMON_TCG_API_KEY;e&&(window.POKEMON_TCG_API_KEY=e)}let{findCardsByQueries:t}=await Promise.all([r.e(478),r.e(252)]).then(r.bind(r,5252));return await t({q:"set.id:".concat(e)})}catch(e){return console.error("Error fetching cards:",e),[]}}};function l(){return(0,o.jsx)("div",{className:"flex items-center justify-center",children:(0,o.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-gray-900 dark:border-gray-100"})})}function c(){let{user:e,hasCard:t,addCard:r,removeCard:n}=(0,a.y)(),[c,d]=(0,i.useState)([]),[u,h]=(0,i.useState)(null),[g,m]=(0,i.useState)([]),[y,f]=(0,i.useState)(!0),[x,b]=(0,i.useState)(null),[p,w]=(0,i.useState)(1),[v,j]=(0,i.useState)(!0);(0,i.useEffect)(()=>{(async()=>{try{let e=await s.getSets(p);if(e.length>0){let t=new Map(c.map(e=>[e.id,e]));e.forEach(e=>{t.has(e.id)||t.set(e.id,e)}),d(Array.from(t.values())),j(24===e.length)}else j(!1)}catch(e){b("Failed to load card sets"),console.error("Error loading sets:",e)}finally{f(!1)}})()},[p]);let E=async e=>{h(e),f(!0);try{let t=await s.getCards(e.id);m(t)}catch(e){b("Failed to load cards"),console.error("Error loading cards:",e)}finally{f(!1)}};return e?y&&0===c.length?(0,o.jsx)("div",{className:"flex justify-center items-center min-h-[50vh]",children:(0,o.jsx)(l,{})}):x?(0,o.jsx)("div",{className:"text-center mt-8",children:(0,o.jsx)("p",{className:"text-red-600",children:x})}):(0,o.jsxs)("main",{className:"container mx-auto px-4 py-8",children:[(0,o.jsx)("h1",{className:"text-4xl font-bold mb-8 text-center text-gray-900 dark:text-gray-100",children:"Pokemon Card Tracker"}),u?(0,o.jsxs)(o.Fragment,{children:[(0,o.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,o.jsxs)("h2",{className:"text-2xl font-semibold text-gray-900 dark:text-gray-100",children:[u.name," Cards"]}),(0,o.jsx)("button",{onClick:()=>{h(null),m([])},className:"px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors",children:"Back to Sets"})]}),(0,o.jsx)("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-6 gap-4",children:g.map(e=>(0,o.jsxs)("div",{className:"border rounded-lg p-4 shadow-sm hover:shadow-md transition-shadow",children:[(0,o.jsx)("img",{src:e.images.small,alt:e.name,className:"w-full h-auto mb-2"}),(0,o.jsx)("h3",{className:"font-semibold text-lg",children:e.name}),(0,o.jsx)("p",{className:"text-gray-600 text-sm mb-2",children:e.set.name}),(0,o.jsx)("button",{onClick:()=>t(e.id)?n(e.id):r(e.id),className:"w-full py-1 px-3 rounded ".concat(t(e.id)?"bg-red-500 hover:bg-red-600 text-white":"bg-blue-500 hover:bg-blue-600 text-white"),children:t(e.id)?"Remove from Collection":"Add to Collection"})]},e.id))})]}):(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("h2",{className:"text-2xl font-semibold mb-4 text-gray-900 dark:text-gray-100",children:"Available Sets"}),(0,o.jsx)("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-6 gap-4",children:c.map(e=>(0,o.jsxs)("div",{className:"cursor-pointer group",onClick:()=>E(e),children:[(0,o.jsx)("div",{className:"relative aspect-[2.5/3.5] rounded-lg overflow-hidden",children:(0,o.jsx)("img",{src:e.images.logo,alt:e.name,className:"w-full h-full object-contain p-4 transition-transform group-hover:scale-110"})}),(0,o.jsx)("div",{className:"mt-2 text-sm font-medium text-center text-gray-900 dark:text-gray-100",children:e.name}),(0,o.jsxs)("div",{className:"text-xs text-center text-gray-500 dark:text-gray-400",children:[e.total," cards"]})]},e.id))}),v&&(0,o.jsx)("div",{className:"mt-8 text-center",children:(0,o.jsx)("button",{onClick:()=>{v&&!y&&w(e=>e+1)},disabled:y,className:"px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors disabled:opacity-50",children:y?"Loading...":"Load More Sets"})})]})]}):(0,o.jsx)("div",{className:"text-center mt-8",children:(0,o.jsx)("p",{className:"text-gray-600",children:"Please log in to view and manage your card collection."})})}},5971:function(e,t,r){"use strict";let o;r.d(t,{JJ:function(){return d},kV:function(){return u},mw:function(){return c},ni:function(){return m},y1:function(){return h},yv:function(){return y},zB:function(){return g}});var i=r(6142),a=r(8121),n=r(2730);let s=null,l=null;function c(){if(s)return{db:s,auth:l};let e={apiKey:"AIzaSyAFDt7q24P_T3TgYkpkxCrVrVblwVE3CEI",authDomain:"pokemon-card-tracker-87d04.firebaseapp.com",projectId:"pokemon-card-tracker-87d04",storageBucket:"pokemon-card-tracker-87d04.firebasestorage.app",messagingSenderId:"824609169487",appId:"1:824609169487:web:2e3301ef05186d85d80a3a"};try{if(console.log("[Firebase] Initializing with config:",{hasApiKey:!!e.apiKey,hasProjectId:!!e.projectId,env:"production",envVars:{apiKey:"set",projectId:"set"}}),!e.apiKey||!e.projectId)throw Error("Firebase configuration is incomplete");return o=(0,i.ZF)(e),console.log("[Firebase] App initialized"),s=(0,a.ad)(o),l=(0,n.v0)(o),console.log("[Firebase] Firestore and Auth initialized"),{db:s,auth:l}}catch(e){throw console.error("[Firebase] Initialization error:",e),e}}async function d(e){if(!s)throw Error("Firestore not initialized");try{let t=(0,a.JU)(s,"collections",e),r=await (0,a.QT)(t);if(r.exists())return r.data();return null}catch(e){throw console.error("[Firebase] Error getting collection:",e),e}}async function u(e,t){if(!s)throw Error("Firestore not initialized");try{let r=(0,a.JU)(s,"collections",e);await (0,a.pl)(r,t)}catch(e){throw console.error("[Firebase] Error saving collection:",e),e}}async function h(e,t){if(!l)throw Error("Auth not initialized");try{return(await (0,n.Xb)(l,e,t)).user}catch(e){throw console.error("[Firebase] Error signing up:",e),e}}async function g(e,t){if(!l)throw Error("Auth not initialized");try{return(await (0,n.e5)(l,e,t)).user}catch(e){throw console.error("[Firebase] Error signing in:",e),e}}async function m(){if(!l)throw Error("Auth not initialized");try{await (0,n.w7)(l)}catch(e){throw console.error("[Firebase] Error signing out:",e),e}}function y(e){if(!l)throw Error("Auth not initialized");return(0,n.Aj)(l,e)}},9799:function(e,t,r){"use strict";r.d(t,{y:function(){return n}});var o=r(2020),i=r(5249),a=r(5971);let n=(0,o.Ue)()((0,i.tJ)((e,t)=>({user:null,collection:{},hydrated:!1,error:null,setHydrated:()=>e({hydrated:!0}),setUser:async r=>{if(e({user:r}),r)try{let o=await (0,a.JJ)(r.uid);o?(console.log("Found existing collection for user:",r.uid),e({collection:o.collection})):(console.log("No existing collection found for user:",r.uid),e({collection:{}})),await t().syncWithFirebase()}catch(t){console.error("Error loading collection:",t),e({error:"Failed to load collection"})}else e({collection:{}})},addCard:async r=>{e(e=>({collection:{...e.collection,[r]:!0}})),await t().syncWithFirebase()},removeCard:async r=>{e(e=>{let t={...e.collection};return delete t[r],{collection:t}}),await t().syncWithFirebase()},hasCard:e=>t().collection[e]||!1,setError:t=>e({error:t}),syncWithFirebase:async()=>{let{user:r,collection:o}=t();if(!r){console.log("No user logged in, skipping sync");return}try{console.log("Starting Firebase sync for user:",r.uid),console.log("Collection to sync:",o),await (0,a.kV)(r.uid,{collection:o,lastUpdated:Date.now()});let t=await (0,a.JJ)(r.uid);if(console.log("Verified saved data:",t),!t)throw Error("Failed to verify saved data");e({error:null}),console.log("Firebase sync completed successfully")}catch(t){throw console.error("Error syncing with Firebase:",t),e({error:"Failed to save your collection. Please try again."}),t}}}),{name:"pokemon-collection",partialize:e=>({collection:e.collection}),onRehydrateStorage:()=>async e=>{if(e){try{console.log("Rehydrating storage with state:",e);let t=(0,a.yv)(t=>{console.log("Auth state changed:",null==t?void 0:t.uid),e.setUser(t)});return()=>t()}catch(t){console.error("Error initializing store:",t),e.setError("Failed to initialize. Please refresh the page.")}e.setHydrated()}}}))}},function(e){e.O(0,[358,638,589,971,69,744],function(){return e(e.s=208)}),_N_E=e.O()}]);